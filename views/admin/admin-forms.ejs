<%- include('../partials/header') %>
<%- include('../partials/admin-nav') %>

<div class="container page-content">
  <h2 class="page-title"><%= title %></h2>


  <form class.="event-form" action="<%= actionUrl %>" method="POST">
    
    <!-- Event Name -->
    <div class="form-group">
      <label for="name">Event Name</label>
      <input 
        type="text" 
        id="name" 
        name="name" 
        value="<%= event.name || '' %>" 
        required
      >
    </div>

    <!-- Event Date & Time -->
    <div class="form-group">
      <label for="date">Event Date & Time</label>
      
      <% 
        let eventDate = '';
        if (event.date) {
          // Input type 'datetime-local' requires format YYYY-MM-DDTHH:MM
          const d = new Date(event.date);
          // Adjust for timezone offset
          d.setMinutes(d.getMinutes() - d.getTimezoneOffset());
          eventDate = d.toISOString().slice(0, 16);
        }
      %>
      <input 
        type="datetime-local" 
        id="date" 
        name="date" 
        value="<%= eventDate %>" 
        required
      >
    </div>
    
    <!-- Event Location (Address) -->
    <div class="form-group">
      <label for="location">Location (Full Address)</label>
      <input 
        type="text" 
        id="location" 
        name="location" 
        value="<%= event.location || '' %>"
        placeholder="e.g., 1600 Amphitheatre Parkway, Mountain View, CA" 
        required
      >
      <!-- Used to check if location changed on edit -->
      <input type="hidden" name="old_location" value="<%= event.location || '' %>">
    </div>

    <!-- Image URL -->
    <div class="form-group">
      <label for="image_url">Image URL</label>
      <input 
        type="text" 
        id="image_url" 
        name="image_url" 
        value="<%= event.image_url || '' %>"
        placeholder="https://example.com/image.png"
      >
    </div>

    <!-- Event Description -->
    <div class="form-group">
      <label for="description">Description</label>
      <textarea 
        id="description" 
        name="description" 
        rows="8" 
        required
      ><%= event.description || '' %></textarea>
    </div>

    <!-- Submit Button -->
    <div class="form-group">
      <button type="submit" class="btn btn-primary">Save Event</button>
      <a href="/admin/manage-events" class="btn btn-secondary">Cancel</a>
    </div>

  </form>
</div>

<%- include('../partials/footer') %>
